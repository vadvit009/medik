{"version":3,"sources":["pages/Order/Order.module.css","pages/Order/Order.js"],"names":["module","exports","connect","state","cartProducts","cart","all","fullPrice","cities","order","warehouses","selectedWarehouse","selectedCity","user","profile","dispatch","addToCart","product","addToCartAction","removeFromCart","removeFromCartAction","setFullPrice","setFullPriceAction","getCities","getCitiesAction","filterCities","filterValue","limit","getWarehouses","city","getWarehousesAction","filterWarehouses","setSelectedCity","setSelectedCityAction","setSelectedWarehouse","warehouse","setSelectedWarehouseAction","patchUser","token","patchUserAction","deliveryOptions","value","label","payOptions","breadCrumbsItems","name","path","icon","faShoppingCart","useState","fName","setName","lName","surname","setSurname","isSaveUser","setSaveUser","deliveryType","setDeliveryType","paymentType","setPaymentType","h","useHistory","useEffect","reduce","acc","price","numberInCart","selectedAttributesPrice","className","s","container","title__container","title","items","order__container","products__container","map","isSmall","key","_id","subtotal__container","subtotal__title","subtotal__price","submit__container_all","submit__container","submit__title","input__row","inputClass","input","containerClass","input__container","onChange","target","placeholder","section","options","onSelect","withSearch","noDefaultValue","onMenuScroll","searchValue","scrollHeight","scrollTop","length","menuClass","select__menu","Description","option","onSearchValueChange","actions__container","save__user__container","type","checked","save__user__checkbox","save__user__desc","onClick","prev","submit__btn__container","isDisabled","disabled","submit__btn","goBack__but","goBack","faArrowLeft"],"mappings":"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","file":"static/js/24.f4e97452.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"title__container\":\"Order_title__container__2jVos\",\"section\":\"Order_section__1AHVU\",\"title\":\"Order_title__2tfhQ\",\"order__container\":\"Order_order__container__2VE4I\",\"submit__container\":\"Order_submit__container__7TdUu\",\"submit__title\":\"Order_submit__title__11NrT\",\"submit__container_all\":\"Order_submit__container_all__36go3\",\"price\":\"Order_price__3J-33\",\"status\":\"Order_status__2Bx9E\",\"products__container\":\"Order_products__container__1Gm1-\",\"products__header\":\"Order_products__header__OZmNZ\",\"sort__container\":\"Order_sort__container__3mUEf\",\"actions__container\":\"Order_actions__container__30EzH\",\"goBack__but\":\"Order_goBack__but__2_oiE\",\"goBack\":\"Order_goBack__343u9\",\"submit__btn__container\":\"Order_submit__btn__container__3Bg_K\",\"input__row\":\"Order_input__row__3BIVP\",\"input__container\":\"Order_input__container__2lXP2\",\"input\":\"Order_input__nX-MZ\",\"subtotal__container\":\"Order_subtotal__container__2MS55\",\"subtotal__title\":\"Order_subtotal__title__1Rihj\",\"subtotal__price\":\"Order_subtotal__price__2WnIY\",\"save__user__container\":\"Order_save__user__container__1PXiP\",\"save__user__desc\":\"Order_save__user__desc__3m2f_\",\"save__user__checkbox\":\"Order_save__user__checkbox__2E450\"};","import React, { useState, useEffect, useRef } from \"react\";\nimport s from \"./Order.module.css\";\nimport { connect } from \"react-redux\";\nimport FixedWrapper from \"../../wrappers/FixedWrapper/FixedWrapper\";\nimport Select from \"../../misc/Select/Select\";\nimport Button from \"../../misc/Button/Button\";\nimport { useHistory } from \"react-router-dom\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faArrowLeft, faShoppingCart } from \"@fortawesome/free-solid-svg-icons\";\nimport CartProduct from \"../../misc/CartProductCard/CartProduct\";\nimport {\n  addToCartAction,\n  removeFromCartAction,\n  setFullPriceAction,\n} from \"../../store/actions/cartActions\";\nimport BreadCrumbs from \"../../misc/BreadCrumbs/BreadCrumbs\";\nimport { Formik } from \"formik\";\nimport Input from \"../../misc/Inputs/Input/Input\";\nimport {\n  getCitiesAction,\n  getWarehousesAction,\n  setSelectedCityAction,\n  setSelectedWarehouseAction,\n} from \"../../store/actions/orderActions\";\nimport OrderProductCard from \"../../misc/OrderProductCard/OrderProductCard\";\nimport { patchUserAction } from \"../../store/actions/profileActions\";\n\nconst CreateOrder = ({\n  cartProducts,\n  fullPrice,\n  setFullPrice,\n  getCities,\n  getWarehouses,\n  cities,\n  filterCities,\n  setSelectedWarehouse,\n  setSelectedCity,\n  warehouses,\n  filterWarehouses,\n  selectedWarehouse,\n  selectedCity,\n  user,\n  patchUser,\n}) => {\n  const deliveryOptions = [\n    { value: \"self-pickup\", label: \"Самовивіз\" },\n    { value: \"np\", label: \"Нова пошта\" },\n    { value: \"up\", label: \"Укр пошта\" },\n  ];\n\n  const payOptions = [\n    { value: \"cash\", label: \"Наложений платіж\" },\n    { value: \"card\", label: \"Картою\" },\n  ];\n\n  const breadCrumbsItems = [\n    {\n      name: \"Кошик\",\n      path: \"/cart\",\n      icon: <FontAwesomeIcon icon={faShoppingCart} />,\n    },\n    { name: \"Замовлення\", path: \"/order\" },\n  ];\n\n  const [name, setName] = useState(user.fName);\n  const [surname, setSurname] = useState(user.lName);\n  const [isSaveUser, setSaveUser] = useState(false);\n  const [deliveryType, setDeliveryType] = useState(deliveryOptions[0]);\n  const [paymentType, setPaymentType] = useState(payOptions[0]);\n\n  const onNameInputChange = ({ target }) => setName(target.value);\n  const onSurnameInputChange = ({ target }) => setSurname(target.value);\n\n  const onSaveUserCheckboxChange = ({ target }) => setSaveUser(target.value);\n  const switchSaveUser = () => setSaveUser((prev) => !prev);\n\n  const onCitiesScroll = ({ target }, searchValue) => {\n    if (\n      target.scrollHeight - target.scrollTop < 400 &&\n      cities.length % 20 === 0\n    ) {\n      filterCities(searchValue, cities.length + 20);\n    }\n  };\n\n  const onCitySearchChange = (value) => {\n    if (cities.length === 1 && value === cities[0].Description) {\n      setSelectedCity(value);\n      getWarehouses(value);\n    }\n    filterCities(value);\n  };\n\n  const onCitySelect = (option) => {\n    setSelectedCity(option.label);\n    getWarehouses(option.label);\n  };\n\n  const onWarehousesScroll = ({ target }, searchValue) => {\n    if (\n      target.scrollHeight - target.scrollTop < 400 &&\n      warehouses.length % 20 === 0\n    ) {\n      filterWarehouses(searchValue, warehouses.length + 20);\n    }\n  };\n\n  const onWarehouseSearchChange = (value) => {\n    // setWarehouseSearchValue(value);\n    // if (warehouses.length === 1 && value === warehouses[0].Description) {\n    //   setSelectedWarehouse(value);\n    // }\n    // filterWarehouses(value);\n  };\n\n  const onWarehouseSelect = (option) => {\n    setSelectedWarehouse(option.label);\n  };\n\n  const h = useHistory();\n\n  const submit = () => {\n    if (isSaveUser) {\n      patchUser({ ...user, fName: name, lName: surname });\n    }\n  };\n\n  useEffect(() => {\n    setFullPrice(\n      cartProducts.reduce(\n        (acc, { price, numberInCart = 1, selectedAttributesPrice }) => {\n          const productPrice = +selectedAttributesPrice || price;\n          return acc + productPrice * numberInCart;\n        },\n        0\n      )\n    );\n  }, [cartProducts]);\n\n  useEffect(() => {\n    getCities();\n  }, []);\n\n  return (\n    <div className={s.container}>\n      <div className={s.title__container}>\n        <h4 className={s.title}>Замовлення</h4>\n        <BreadCrumbs items={breadCrumbsItems} />\n      </div>\n      <FixedWrapper>\n        <div className={s.order__container}>\n          <div className={s.products__container}>\n            {cartProducts.map((product) => (\n              <OrderProductCard isSmall {...{ product }} key={product._id} />\n            ))}\n            <div className={s.subtotal__container}>\n              <div className={s.subtotal__title}>Ціна:</div>\n              <div className={s.subtotal__price}>{fullPrice}₴</div>\n            </div>\n          </div>\n          <div className={s.submit__container_all}>\n            <div className={s.submit__container}>\n              <h2 className={s.submit__title}>Оформити замовлення</h2>\n              <div className={s.input__row}>\n                <Input\n                  name=\"fName\"\n                  inputClass={s.input}\n                  containerClass={s.input__container}\n                  value={name}\n                  onChange={onNameInputChange}\n                  label=\"Ім'я\"\n                  placeholder=\"John\"\n                />\n                <Input\n                  placeholder=\"Doe\"\n                  name=\"sName\"\n                  inputClass={s.input}\n                  containerClass={s.input__container}\n                  value={surname}\n                  onChange={onSurnameInputChange}\n                  label=\"Прізвище\"\n                />\n              </div>\n              <Select\n                containerClass={s.section}\n                options={payOptions}\n                onSelect={setPaymentType}\n                label=\"Тип оплати\"\n                value={paymentType.label}\n              />\n              <Select\n                containerClass={s.section}\n                options={deliveryOptions}\n                onSelect={setDeliveryType}\n                label=\"Тип доставки\"\n                value={deliveryType.label}\n              />\n              <Select\n                containerClass={s.section}\n                withSearch\n                noDefaultValue\n                onMenuScroll={onCitiesScroll}\n                menuClass={s.select__menu}\n                options={cities.map((city) => ({\n                  value: city.Description,\n                  label: city.Description,\n                }))}\n                onSelect={onCitySelect}\n                onSearchValueChange={onCitySearchChange}\n                label=\"Місто\"\n              />\n              <Select\n                containerClass={s.section}\n                withSearch\n                noDefaultValue\n                onMenuScroll={onWarehousesScroll}\n                menuClass={s.select__menu}\n                options={warehouses.map((warehouse) => ({\n                  value: warehouse.Description,\n                  label: warehouse.Description,\n                }))}\n                onSelect={onWarehouseSelect}\n                onSearchValueChange={onWarehouseSearchChange}\n                label=\"Номер відділення\"\n              />\n              <div className={s.actions__container}>\n                <div className={s.save__user__container}>\n                  <input\n                    type=\"checkbox\"\n                    onChange={onSaveUserCheckboxChange}\n                    checked={isSaveUser}\n                    className={s.save__user__checkbox}\n                  />\n                  <p className={s.save__user__desc} onClick={switchSaveUser}>\n                    Оновити мій профіль\n                  </p>\n                </div>\n                <div className={s.submit__btn__container}>\n                  <Button\n                    title=\"Підтвердити замовлення\"\n                    onClick={submit}\n                    isDisabled={!selectedCity || !selectedWarehouse}\n                    disabled={!selectedCity || !selectedWarehouse}\n                    className={s.submit__btn}\n                  />\n                </div>\n                <button\n                  className={s.goBack__but}\n                  onClick={() => {\n                    h.goBack();\n                  }}\n                >\n                  <FontAwesomeIcon icon={faArrowLeft} className={s.goBack} />\n                  Повернутися\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </FixedWrapper>\n    </div>\n  );\n};\n\nconst mapStateToProps = (state) => {\n  return {\n    cartProducts: state.cart.all,\n    fullPrice: state.cart.fullPrice,\n    cities: state.order.cities,\n    warehouses: state.order.warehouses,\n    selectedWarehouse: state.order.selectedWarehouse,\n    selectedCity: state.order.selectedCity,\n    user: state.profile,\n  };\n};\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    addToCart: (product) => dispatch(addToCartAction(product)),\n    removeFromCart: (product) => dispatch(removeFromCartAction(product)),\n    setFullPrice: (fullPrice) => dispatch(setFullPriceAction(fullPrice)),\n    getCities: () => dispatch(getCitiesAction()),\n    filterCities: (filterValue, limit) =>\n      dispatch(getCitiesAction(filterValue, limit)),\n    getWarehouses: (city) => dispatch(getWarehousesAction(city)),\n    filterWarehouses: (filterValue) =>\n      dispatch(getWarehousesAction(filterValue)),\n    setSelectedCity: (city) => dispatch(setSelectedCityAction(city)),\n    setSelectedWarehouse: (warehouse) =>\n      dispatch(setSelectedWarehouseAction(warehouse)),\n    patchUser: (user, token) => dispatch(patchUserAction(user, token)),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(CreateOrder);\n"],"sourceRoot":""}